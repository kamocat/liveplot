<html><head>
<link rel="stylesheet" href="/static/uPlot/dist/uPlot.min.css">
<script src="/static/uPlot/dist/uPlot.iife.js"></script>
<script>
	let opts = {
		title: "Acceleration",
		id: "chart1",
		class: "mychart",
		width: 500,
		height: 400,
		series: [
			{
				scale: "seconds",
				label: "seconds",
			},{
				scale: "acceleration",
				label: "X",
				stroke:"red",
				width: 1,
			},{
				scale: "acceleration",
				label: "Y",
				stroke:"green",
				width: 1,
			},{
				scale: "acceleration",
				label: "Z",
				stroke:"blue",
				width: 1,
			},
		],
		scales: {
			"seconds": {
				time: false,
			},
			"acceleration": {
				auto: false,
				range: [-2, 2]
			},
		},
	}
	let source = "/data";
	function empty() {}
	async function loop(){
		let plot = await fetch(source)
			.then((response) => response.json())
			.then((data) => new uPlot(opts, data, document.body));
		for(;;){
			// Our loop is most likely limited by network delay
			// So no need to use requestAnimationFrame()
			await fetch(source)
				.then((response) => response.json())
				.then((data) => plot.setData(data));
		}

	}
	loop();
</script></head>
<body>

</body></html>

